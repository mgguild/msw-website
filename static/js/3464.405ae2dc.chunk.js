"use strict";(self.webpackChunkMetaSaga_Warriors=self.webpackChunkMetaSaga_Warriors||[]).push([[3464],{43464:(e,t,i)=>{i.d(t,{O0:()=>O,PaperEmbeddedWalletSdk:()=>H,k3:()=>A});var r,n,o,l=i(80080),a=i(5952),s=i(75672),d=i(63604),c=Object.defineProperty,u=Object.defineProperties,h=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,I=(e,t,i)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,v=(e,t)=>{for(var i in t||(t={}))p.call(t,i)&&I(e,i,t[i]);if(g)for(var i of g(t))m.call(t,i)&&I(e,i,t[i]);return e},w=(e,t)=>u(e,h(t)),y=(e,t,i)=>new Promise(((r,n)=>{var o=e=>{try{a(i.next(e))}catch(t){n(t)}},l=e=>{try{a(i.throw(e))}catch(t){n(t)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,l);a((i=i.apply(e,t)).next())})),f="/sdk/2022-08-12/embedded-wallet",L=("".concat(f,"/auth/headless-google-login-managed"),e=>"paperEwsWalletUserId-".concat(e)),E=e=>"".concat("walletToken","-").concat(e),S=(e,t)=>"".concat("a","-").concat(e,"-").concat(t),A=((n=A||{}).USER_MANAGED="USER_MANAGED",n.AWS_MANAGED="AWS_MANAGED",n),W=((r=W||{}).PAPER_EMAIL_OTP="PaperEmailOTP",r.GOOGLE="Google",r.TWITTER="Twitter",r.COGNITO="Cognito",r.AUTH0="Auth0",r.CUSTOM_JWT="CustomJWT",r),O=(e=>(e.LOGGED_OUT="Logged Out",e.LOGGED_IN_WALLET_INITIALIZED="Logged In, Wallet Initialized",e))(O||{}),M=((o=M||{}).LOGGED_OUT="Logged Out",o.LOGGED_IN_WALLET_UNINITIALIZED="Logged In, Wallet Uninitialized",o.LOGGED_IN_NEW_DEVICE="Logged In, New Device",o.LOGGED_IN_WALLET_INITIALIZED="Logged In, Wallet Initialized",o),D=new Map,N=class{constructor(e){let{clientId:t}=e;this.isSupported="undefined"!=typeof window&&!!window.localStorage,this.clientId=t}getItem(e){return y(this,null,(function*(){var t;return this.isSupported?window.localStorage.getItem(e):null!=(t=D.get(e))?t:null}))}setItem(e,t){return y(this,null,(function*(){if(this.isSupported)return window.localStorage.setItem(e,t);D.set(e,t)}))}removeItem(e){return y(this,null,(function*(){let t=yield this.getItem(e);return!(!this.isSupported||!t)&&(window.localStorage.removeItem(e),!0)}))}saveAuthCookie(e){return y(this,null,(function*(){yield this.setItem(E(this.clientId),e)}))}getAuthCookie(){return y(this,null,(function*(){return this.getItem(E(this.clientId))}))}removeAuthCookie(){return y(this,null,(function*(){return this.removeItem(E(this.clientId))}))}saveDeviceShare(e,t){return y(this,null,(function*(){yield this.saveWalletUserId(t),yield this.setItem(S(this.clientId,t),e)}))}getDeviceShare(){return y(this,null,(function*(){let e=yield this.getWalletUserId();return e?this.getItem(S(this.clientId,e)):null}))}removeDeviceShare(){return y(this,null,(function*(){let e=yield this.getWalletUserId();return!!e&&this.removeItem(S(this.clientId,e))}))}getWalletUserId(){return y(this,null,(function*(){return this.getItem(L(this.clientId))}))}saveWalletUserId(e){return y(this,null,(function*(){yield this.setItem(L(this.clientId),e)}))}removeWalletUserId(){return y(this,null,(function*(){return this.removeItem(L(this.clientId))}))}};function _(e){return new Promise((t=>{setTimeout(t,1e3*e)}))}var C={height:"100%",width:"100%",border:"none",backgroundColor:"transparent",colorScheme:"light",position:"fixed",top:"0px",right:"0px",zIndex:"2147483646",display:"none"},P=new Map,b=class{constructor(e){let{link:t,iframeId:i,container:r=document.body,iframeStyles:n,onIframeInitialize:o}=e;this.POLLING_INTERVAL_SECONDS=1.4,this.POST_LOAD_BUFFER_SECONDS=1;let l=document.getElementById(i),a=new URL(t),s="1.2.5";if(a.searchParams.set("sdkVersion",s),!l||l.src!=a.href){if(!l){l=document.createElement("iframe");let e=v(v({},C),n);Object.assign(l.style,e),l.setAttribute("id",i),l.setAttribute("fetchpriority","high"),r.appendChild(l)}l.src=a.href,l.setAttribute("data-version",s),l.onload=this.onIframeLoadHandler(l,this.POST_LOAD_BUFFER_SECONDS,o)}this.iframe=l}onIframeLoadedInitVariables(){return y(this,null,(function*(){return{}}))}onIframeLoadHandler(e,t,i){return()=>y(this,null,(function*(){yield new Promise(((r,n)=>y(this,null,(function*(){var o;let a=new MessageChannel;a.port1.onmessage=t=>{let{data:o}=t;return a.port1.close(),o.success?(P.set(e.src,!0),i&&i(),r(!0)):n(new Error(o.error))},yield _(t);null==(o=null==e?void 0:e.contentWindow)||o.postMessage({eventType:"initIframe",data:yield this.onIframeLoadedInitVariables()},"".concat((0,l.IZ)()).concat(f),[a.port2])}))))}))}call(e){return y(this,arguments,(function(e){var t=this;let{procedureName:i,params:r,showIframe:n=!1,injectRecoveryCode:o={isInjectRecoveryCode:!1}}=e;return function*(){for(;!P.get(t.iframe.src);)yield _(t.POLLING_INTERVAL_SECONDS);return n&&(t.iframe.style.display="block",yield _(.005)),new Promise(((e,a)=>{var s;if(o.isInjectRecoveryCode){let e=i=>y(t,null,(function*(){var t,r;if(i.origin!==(0,l.IZ)()||"paper_getRecoveryCode"!==i.data.type||"string"!=typeof i.data.userWalletId)return;let n=yield null==(t=o.getRecoveryCode)?void 0:t.call(o,i.data.userWalletId);null==(r=this.iframe.contentWindow)||r.postMessage({type:"paper_getRecoveryCode_response",recoveryCode:n},(0,l.IZ)()),window.removeEventListener("message",e)}));window.addEventListener("message",e)}let d=new MessageChannel;d.port1.onmessage=i=>y(t,null,(function*(){let{data:t}=i;d.port1.close(),n&&(yield _(.1),this.iframe.style.display="none"),t.success?e(t.data):a(new Error(t.error))})),null==(s=t.iframe.contentWindow)||s.postMessage({eventType:i,data:r},"".concat((0,l.IZ)()).concat(f),[d.port2])}))}()}))}destroy(){P.delete(this.iframe.src)}},T=class extends b{constructor(e){let{clientId:t,customizationOptions:i}=e;super({iframeId:G,link:U({clientId:t,path:f,queryParams:i}).href,container:document.body}),this.clientId=t}onIframeLoadedInitVariables(){return y(this,null,(function*(){let e=new N({clientId:this.clientId});return{authCookie:yield e.getAuthCookie(),deviceShareStored:yield e.getDeviceShare(),walletUserId:yield e.getWalletUserId(),clientId:this.clientId}}))}};function U(e){let{clientId:t,path:i,queryParams:r}=e;var n;let o=new URL(i,(0,l.IZ)());if(r)for(let l of Object.keys(r))o.searchParams.set(l,(null==(n=r[l])?void 0:n.toString())||"");return o.searchParams.set("clientId",t),o}var G="paper-embedded-wallet-iframe",k=class{constructor(e){let{querier:t,preLogin:i,postLogin:r,clientId:n}=e;this.LoginQuerier=t,this.preLogin=i,this.postLogin=r,this.clientId=n}sendPaperEmailLoginOtp(e){return y(this,arguments,(function(e){var t=this;let{email:i,recoveryShareManagement:r}=e;return function*(){yield t.preLogin();let{isNewUser:e,isNewDevice:n,recoveryShareManagement:o}=yield t.LoginQuerier.call({procedureName:"sendPaperEmailLoginOtp",params:{email:i,recoveryShareManagement:r}});return{isNewUser:e,isNewDevice:n,recoveryShareManagement:o}}()}))}},R=class extends k{constructor(){super(...arguments),this.closeWindow=e=>{let{isWindowOpenedByFn:t,win:i,closeOpenedWindow:r}=e;t?null==i||i.close():i&&r?r(i):i&&i.close()}}loginWithPaperModal(){return y(this,null,(function*(){yield this.preLogin();let e=yield this.LoginQuerier.call({procedureName:"loginWithPaperModal",params:{recoveryShareManagement:"AWS_MANAGED"},showIframe:!0,injectRecoveryCode:{isInjectRecoveryCode:!0}});return this.postLogin(e)}))}getGoogleLoginUrl(){return y(this,null,(function*(){return yield this.LoginQuerier.call({procedureName:"getHeadlessGoogleLoginLink",params:void 0})}))}loginWithGoogle(e){return y(this,null,(function*(){yield this.preLogin();let t=null==e?void 0:e.openedWindow,i=!1;if(t||(t=window.open("","Login","width=350, height=500"),i=!0),!t)throw new Error("Something went wrong opening pop-up");yield this.preLogin();let{loginLink:r}=yield this.getGoogleLoginUrl();t.location.href=r;let n=yield new Promise(((r,n)=>{let o=window.setInterval((()=>y(this,null,(function*(){t&&t.closed&&(clearInterval(o),window.removeEventListener("message",a),n(new Error("User closed login window")))}))),1e3),a=s=>y(this,null,(function*(){if(s.origin===(0,l.IZ)()){if("object"!=typeof s.data)return void n(new Error("Invalid event data"));switch(s.data.eventType){case"userLoginSuccess":window.removeEventListener("message",a),clearInterval(o),this.closeWindow({isWindowOpenedByFn:i,win:t,closeOpenedWindow:null==e?void 0:e.closeOpenedWindow}),s.data.authResult&&r(s.data.authResult);break;case"userLoginFailed":window.removeEventListener("message",a),clearInterval(o),this.closeWindow({isWindowOpenedByFn:i,win:t,closeOpenedWindow:null==e?void 0:e.closeOpenedWindow}),n(new Error(s.data.error));break;case"injectDeveloperClientId":null==t||t.postMessage({eventType:"injectDeveloperClientIdResult",developerClientId:this.clientId},(0,l.IZ)())}}}));window.addEventListener("message",a)}));return this.postLogin({storedToken:w(v({},n.storedToken),{shouldStoreCookieString:!0}),walletDetails:w(v({},n.walletDetails),{isIframeStorageEnabled:!1})})}))}loginWithPaperEmailOtp(e){return y(this,arguments,(function(e){var t=this;let{email:i}=e;return function*(){yield t.preLogin();let e=yield t.LoginQuerier.call({procedureName:"loginWithPaperModal",params:{email:i,recoveryShareManagement:"AWS_MANAGED"},showIframe:!0,injectRecoveryCode:{isInjectRecoveryCode:!0}});return t.postLogin(e)}()}))}verifyPaperEmailLoginOtp(e){return y(this,arguments,(function(e){var t=this;let{email:i,otp:r}=e;return function*(){let e=yield t.LoginQuerier.call({procedureName:"verifyPaperEmailLoginOtp",params:{email:i,otp:r,recoveryShareManagement:"AWS_MANAGED"},injectRecoveryCode:{isInjectRecoveryCode:!0}});return t.postLogin(e)}()}))}},j=class extends k{loginWithPaperModal(e){return y(this,null,(function*(){yield this.preLogin();let t=yield this.LoginQuerier.call({procedureName:"loginWithPaperModal",params:void 0,showIframe:!0,injectRecoveryCode:{isInjectRecoveryCode:!0,getRecoveryCode:null==e?void 0:e.getRecoveryCode}});return this.postLogin(t)}))}loginWithGoogle(e){return y(this,null,(function*(){throw new Error("loginWithGoogle is not yet supported in the RecoveryShareManagement.USER_MANAGED flow. Please use RecoveryShareManagement.AWS_MANAGED instead.")}))}loginWithPaperEmailOtp(e){return y(this,arguments,(function(e){var t=this;let{email:i,recoveryCode:r}=e;return function*(){yield t.preLogin();let e=yield t.LoginQuerier.call({procedureName:"loginWithPaperModal",params:{email:i,recoveryCode:r},showIframe:!0,injectRecoveryCode:{isInjectRecoveryCode:!0}});return t.postLogin(e)}()}))}verifyPaperEmailLoginOtp(e){return y(this,arguments,(function(e){var t=this;let{email:i,otp:r,recoveryCode:n}=e;return function*(){let e=yield t.LoginQuerier.call({procedureName:"verifyPaperEmailLoginOtp",params:{email:i,otp:r,recoveryCode:n},injectRecoveryCode:{isInjectRecoveryCode:!0}});return t.postLogin(e)}()}))}},q=class{constructor(e){let{clientId:t,advancedOptions:i,querier:r,onAuthSuccess:n}=e;var o;this.clientId=t,this.advancedOptions={recoveryShareManagement:null!=(o=null==i?void 0:i.recoveryShareManagement)?o:"AWS_MANAGED"},this.AuthQuerier=r,this.localStorage=new N({clientId:t}),this.onAuthSuccess=n,this.userManagedLogin=new j({postLogin:e=>y(this,null,(function*(){return this.postLogin(e)})),preLogin:()=>y(this,null,(function*(){yield this.preLogin()})),querier:r,clientId:t}),this.awsManagedLogin=new R({postLogin:e=>y(this,null,(function*(){return this.postLogin(e)})),preLogin:()=>y(this,null,(function*(){yield this.preLogin()})),querier:r,clientId:t})}preLogin(){return y(this,null,(function*(){yield this.logout()}))}postLogin(e){return y(this,arguments,(function(e){var t=this;let{storedToken:i,walletDetails:r}=e;return function*(){return i.shouldStoreCookieString&&(yield t.localStorage.saveAuthCookie(i.cookieString)),yield t.onAuthSuccess({storedToken:i,walletDetails:r})}()}))}loginWithJwtAuth(e){return y(this,arguments,(function(e){var t=this;let{token:i,authProvider:r,recoveryCode:n}=e;return function*(){yield t.preLogin();let e=yield t.AuthQuerier.call({procedureName:"loginWithJwtAuthCallback",params:{token:i,authProvider:r,recoveryCode:n}});return t.postLogin(e)}()}))}loginWithPaperModal(e){return y(this,null,(function*(){return yield this.preLogin(),"AWS_MANAGED"===this.advancedOptions.recoveryShareManagement?this.awsManagedLogin.loginWithPaperModal():this.userManagedLogin.loginWithPaperModal(e)}))}loginWithPaperEmailOtp(e){return y(this,null,(function*(){return"AWS_MANAGED"===this.advancedOptions.recoveryShareManagement?this.awsManagedLogin.loginWithPaperEmailOtp({email:e.email}):this.userManagedLogin.loginWithPaperEmailOtp(e)}))}loginWithGoogle(e){return y(this,null,(function*(){return"AWS_MANAGED"===this.advancedOptions.recoveryShareManagement?this.awsManagedLogin.loginWithGoogle(e):this.userManagedLogin.loginWithGoogle()}))}sendPaperEmailLoginOtp(e){return y(this,arguments,(function(e){var t=this;let{email:i}=e;return function*(){return"AWS_MANAGED"===t.advancedOptions.recoveryShareManagement?t.awsManagedLogin.sendPaperEmailLoginOtp({email:i,recoveryShareManagement:"AWS_MANAGED"}):t.userManagedLogin.sendPaperEmailLoginOtp({email:i})}()}))}verifyPaperEmailLoginOtp(e){return y(this,null,(function*(){return"AWS_MANAGED"===this.advancedOptions.recoveryShareManagement?this.awsManagedLogin.verifyPaperEmailLoginOtp(e):this.userManagedLogin.verifyPaperEmailLoginOtp(e)}))}logout(){return y(this,null,(function*(){let{success:e}=yield this.AuthQuerier.call({procedureName:"logout",params:void 0}),t=yield this.localStorage.removeAuthCookie(),i=yield this.localStorage.removeWalletUserId();return{success:e||t||i}}))}},Q=class{constructor(e){let{chain:t,clientId:i,querier:r}=e;this.chain=t,this.clientId=i,this.gaslessTransactionQuerier=r}callContract(e){return y(this,arguments,(function(e){var t=this;let{contractAddress:i,methodArgs:r,methodInterface:n}=e;return function*(){return yield t.gaslessTransactionQuerier.call({procedureName:"callContract",params:{chain:t.chain,contractAddress:i,method:{args:r,stub:n}}})}()}))}},F=class extends s.Signer{constructor(e){let{provider:t,clientId:i,querier:r}=e;var n;super(),this.DEFAULT_ETHEREUM_CHAIN_ID=5,this.clientId=i,this.querier=r,this.endpoint=null==(n=t.connection)?void 0:n.url,(0,d.defineReadOnly)(this,"provider",t)}getAddress(){return y(this,null,(function*(){let{address:e}=yield this.querier.call({procedureName:"getAddress",params:void 0});return e}))}signMessage(e){return y(this,null,(function*(){var t,i,r,n;let o=yield null==(t=this.provider)?void 0:t.getNetwork();o&&o._defaultProvider;let{signedMessage:l}=yield this.querier.call({procedureName:"signMessage",params:{message:e,chainId:null!=(n=null==(r=yield null==(i=this.provider)?void 0:i.getNetwork())?void 0:r.chainId)?n:this.DEFAULT_ETHEREUM_CHAIN_ID,rpcEndpoint:this.endpoint}});return l}))}signTransaction(e){return y(this,null,(function*(){var t,i,r;let{signedTransaction:n}=yield this.querier.call({procedureName:"signTransaction",params:{transaction:e,chainId:null!=(r=null==(i=yield null==(t=this.provider)?void 0:t.getNetwork())?void 0:i.chainId)?r:this.DEFAULT_ETHEREUM_CHAIN_ID,rpcEndpoint:this.endpoint}});return n}))}_signTypedData(e,t,i){return y(this,null,(function*(){var r,n,o;let{signedTypedData:l}=yield this.querier.call({procedureName:"signTypedDataV4",params:{domain:e,types:t,message:i,chainId:null!=(o=null==(n=yield null==(r=this.provider)?void 0:r.getNetwork())?void 0:n.chainId)?o:this.DEFAULT_ETHEREUM_CHAIN_ID,rpcEndpoint:this.endpoint}});return l}))}connect(e){return new F({clientId:this.clientId,provider:e,querier:this.querier})}},z=class{constructor(e){let{clientId:t,chain:i,querier:r}=e;this.clientId=t,this.chain=i,this.walletManagerQuerier=r,this.gasless=new Q({chain:i,clientId:t,querier:r}),this.localStorage=new N({clientId:t})}postWalletSetUp(e){return y(this,arguments,(function(e){var t=this;let{deviceShareStored:i,walletAddress:r,isIframeStorageEnabled:n,walletUserId:o}=e;return function*(){return n||(yield t.localStorage.saveDeviceShare(i,o)),{walletAddress:r}}()}))}getUserWalletStatus(){return y(this,null,(function*(){let e=yield this.walletManagerQuerier.call({procedureName:"getUserStatus",params:void 0});return"Logged In, Wallet Initialized"===e.status?{status:"Logged In, Wallet Initialized",user:w(v({},e.user),{wallet:this})}:e}))}setChain(e){return y(this,arguments,(function(e){var t=this;let{chain:i}=e;return function*(){t.chain=i,t.gasless=new Q({chain:i,clientId:t.clientId,querier:t.walletManagerQuerier})}()}))}getEthersJsSigner(e){return y(this,null,(function*(){var t;return new F({clientId:this.clientId,provider:(0,a.getDefaultProvider)(null!=(t=null==e?void 0:e.rpcEndpoint)?t:l.eY[this.chain]),querier:this.walletManagerQuerier})}))}},H=class{constructor(e){let{clientId:t,chain:i,styles:r,advancedOptions:n,onAuthSuccess:o}=e;this.clientId=t,this.querier=new T({clientId:t,customizationOptions:r}),this.wallet=new z({clientId:t,chain:i,querier:this.querier}),this.auth=new q({clientId:t,advancedOptions:v({recoveryShareManagement:"USER_MANAGED"},null!=n?n:{}),querier:this.querier,onAuthSuccess:e=>y(this,null,(function*(){return yield this.wallet.postWalletSetUp(w(v({},e.walletDetails),{walletUserId:e.storedToken.authDetails.userWalletId})),yield this.querier.call({procedureName:"initIframe",params:{deviceShareStored:e.walletDetails.deviceShareStored,clientId:this.clientId,walletUserId:e.storedToken.authDetails.userWalletId,authCookie:e.storedToken.cookieString}}),null==o||o(e),{user:{status:"Logged In, Wallet Initialized",authDetails:e.storedToken.authDetails,wallet:this.wallet,walletAddress:e.walletDetails.walletAddress}}}))})}getUser(){return y(this,null,(function*(){let e=yield this.wallet.getUserWalletStatus();switch(e.status){case"Logged In, New Device":case"Logged In, Wallet Uninitialized":return yield this.auth.logout(),this.getUser();case"Logged Out":return{status:"Logged Out"};case"Logged In, Wallet Initialized":return v({status:"Logged In, Wallet Initialized"},e.user)}}))}}},80080:(e,t,i)=>{i.d(t,{IZ:()=>n,eY:()=>r});var r={Ethereum:"https://ethereum.rpc.thirdweb.com",Goerli:"https://goerli.rpc.thirdweb.com",Mumbai:"https://mumbai.rpc.thirdweb.com",Polygon:"https://polygon.rpc.thirdweb.com",Avalanche:"https://avalanche.rpc.thirdweb.com",Optimism:"https://optimism.rpc.thirdweb.com",OptimismGoerli:"https://optimism-goerli.rpc.thirdweb.com",BSC:"https://binance.rpc.thirdweb.com",BSCTestnet:"https://binance-testnet.rpc.thirdweb.com",ArbitrumOne:"https://arbitrum.rpc.thirdweb.com",ArbitrumGoerli:"https://arbitrum-goerli.rpc.thirdweb.com",Fantom:"https://fantom.rpc.thirdweb.com",FantomTestnet:"https://fantom-testnet.rpc.thirdweb.com",Sepolia:"https://sepolia.rpc.thirdweb.com",AvalancheFuji:"https://avalanche-fuji.rpc.thirdweb.com"},n=()=>{var e;return"undefined"!=typeof window&&"true"===window.localStorage.getItem("IS_PAPER_DEV")?null!=(e=window.localStorage.getItem("PAPER_DEV_URL"))?e:"http://localhost:3000":"undefined"!=typeof window&&window.location.origin.includes("paper.xyz")||"undefined"!=typeof window&&window.location.origin.includes("thirdweb.com")?window.location.origin:"https://withpaper.com"}}}]);
//# sourceMappingURL=3464.405ae2dc.chunk.js.map