"use strict";(self.webpackChunkMetaSaga_Warriors=self.webpackChunkMetaSaga_Warriors||[]).push([[6092],{45216:(t,e,i)=>{function n(t){return"string"===typeof t?Number.parseInt(t,"0x"===t.trim().substring(0,2)?16:10):"bigint"===typeof t?Number(t):t}i.d(e,{n:()=>n})},46092:(t,e,i)=>{i.d(e,{PaperWalletConnector:()=>l});var n=i(22516),s=i(80584),o=i(43464),a=i(70036),r=i(45216),h=i(62704),c=i(70252),d=(i(83440),new WeakMap);class l extends c.C{constructor(t){super(),(0,s._)(this,"id",h.w.paper),(0,s._)(this,"name","Paper Wallet"),(0,s._)(this,"ready",!0),(0,s._)(this,"user",null),(0,n._)(this,d,{writable:!0,value:void 0}),(0,s._)(this,"onAccountsChanged",(async t=>{0===t.length?await this.onDisconnect():this.emit("change",{account:a.getAddress(t[0])})})),(0,s._)(this,"onChainChanged",(t=>{const e=(0,r.n)(t),i=-1===this.options.chains.findIndex((t=>t.chainId===e));this.emit("change",{chain:{id:e,unsupported:i}})})),(0,s._)(this,"onDisconnect",(async()=>{this.emit("disconnect")})),this.options=t}getPaperSDK(){return this.paper||(this.paper=new Promise((async(t,e)=>{var n;const s=null===(n=this.options.advancedOptions)||void 0===n?void 0:n.recoveryShareManagement;try{const{PaperEmbeddedWalletSdk:e}=await Promise.resolve().then(i.bind(i,43464)),n={AWS_MANAGED:o.k3.AWS_MANAGED,USER_MANAGED:o.k3.USER_MANAGED};t(new e({advancedOptions:{recoveryShareManagement:s?n[s]:void 0},clientId:this.options.clientId,chain:"Ethereum",styles:this.options.styles,onAuthSuccess:this.options.onAuthSuccess}))}catch(a){e(a)}}))),this.paper}async connect(t){const e=await this.getPaperSDK();if(!e)throw new Error("Paper SDK not initialized");const i=await e.getUser();switch(i.status){case o.O0.LOGGED_OUT:{let i;if(null!==t&&void 0!==t&&t.googleLogin){const n=t.googleLogin;i=await e.auth.loginWithGoogle("object"===typeof n?n:void 0)}else i=null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.otp?await e.auth.verifyPaperEmailLoginOtp({email:t.email,otp:t.otp,recoveryCode:t.recoveryCode}):null!==t&&void 0!==t&&t.email?await e.auth.loginWithPaperEmailOtp({email:t.email}):await e.auth.loginWithPaperModal();this.user=i.user;break}case o.O0.LOGGED_IN_WALLET_INITIALIZED:"object"===typeof(null===t||void 0===t?void 0:t.googleLogin)&&t.googleLogin.closeOpenedWindow&&t.googleLogin.openedWindow&&t.googleLogin.closeOpenedWindow(t.googleLogin.openedWindow),this.user=i}if(!this.user)throw new Error("Error connecting User");return null!==t&&void 0!==t&&t.chainId&&this.switchChain(t.chainId),this.setupListeners(),this.getAddress()}async disconnect(){const t=await this.paper;await(null===t||void 0===t?void 0:t.auth.logout()),(0,n.a)(this,d,void 0),this.user=null}async getAddress(){return(await this.getSigner()).getAddress()}async isConnected(){try{return!!await this.getAddress()}catch(t){return!1}}async getProvider(){const t=await this.getSigner();if(!t.provider)throw new Error("Provider not found");return t.provider}async getSigner(){var t;if((0,n.b)(this,d))return(0,n.b)(this,d);if(!this.user){const t=await this.getPaperSDK(),e=await t.getUser();if(e.status===o.O0.LOGGED_IN_WALLET_INITIALIZED)this.user=e}const e=await(null===(t=this.user)||void 0===t?void 0:t.wallet.getEthersJsSigner({rpcEndpoint:this.options.chain.rpc[0]||""}));if(!e)throw new Error("Signer not found");return(0,n.a)(this,d,e),e}async isAuthorized(){return!1}async switchChain(t){var e,i;const s=this.options.chains.find((e=>e.chainId===t));if(!s)throw new Error("Chain not configured");await(null===(e=this.user)||void 0===e?void 0:e.wallet.setChain({chain:"Ethereum"})),(0,n.a)(this,d,await(null===(i=this.user)||void 0===i?void 0:i.wallet.getEthersJsSigner({rpcEndpoint:s.rpc[0]||""}))),this.emit("change",{chain:{id:t,unsupported:!1}})}async setupListeners(){const t=await this.getProvider();t.on&&(t.on("accountsChanged",this.onAccountsChanged),t.on("chainChanged",this.onChainChanged),t.on("disconnect",this.onDisconnect))}updateChains(t){this.options.chains=t}async getEmail(){if(await this.getProvider(),!this.user)throw new Error("No user found, Paper Wallet is not connected");return this.user.authDetails.email}}}}]);
//# sourceMappingURL=6092.1f47e470.chunk.js.map